(this.webpackJsonpnextbus=this.webpackJsonpnextbus||[]).push([[0],{10:function(e,t,a){e.exports=a(23)},15:function(e,t,a){},17:function(e,t,a){},23:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(9),s=a.n(c),o=(a(15),a(2)),i=a.n(o),u=a(6),l=(a(17),function(e){var t=new Date;return t.setSeconds(t.getSeconds()+e),t}),m=function(){var e=new Date;return{date:e.toISOString().substr(0,10),time:e.toTimeString().substr(0,5)}},p={accessToken:"",expires:null},d=function(e){var t,a;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(h()){r.next=3;break}return r.next=3,i.a.awrap(b());case 3:return r.next=5,i.a.awrap(f(e));case 5:if(401!==(a=r.sent).status){r.next=12;break}return r.next=9,i.a.awrap(b());case 9:return r.next=11,i.a.awrap(f(e));case 11:a=r.sent;case 12:if(200!==a.status){r.next=17;break}return r.next=15,i.a.awrap(a.json());case 15:return t=r.sent,r.abrupt("return",t);case 17:return r.abrupt("return",t);case 18:case"end":return r.stop()}}))},f=function(e){var t,a,r,n,c;return i.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=m(),a=t.date,r=t.time,n="https://api.vasttrafik.se/bin/rest.exe/v2/departureBoard?id=".concat(e,"&date=").concat(a,"&time=").concat(r,"&format=json"),s.next=4,i.a.awrap(fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(p.accessToken)}}));case 4:return c=s.sent,s.abrupt("return",c);case 6:case"end":return s.stop()}}))},h=function(){return!!p.accessToken&&!(p.expires&&p.expires<new Date)},E=function(){var e,t;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.a.awrap(fetch("https://api.vasttrafik.se:443/token",{headers:{Authorization:"Basic ".concat("T0hDc2txdEp6cDhMYlVmRjhsaWVfeERHdDBBYTp6ME5wWWY3dlYxbUFhTEVFbkdyRFprTGEwODBh"),"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:"grant_type=client_credentials"}));case 2:return e=a.sent,a.next=5,i.a.awrap(e.json());case 5:return t=a.sent,a.abrupt("return",t);case 7:case"end":return a.stop()}}))},b=function(){var e,t,a;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.a.awrap(E());case 2:e=r.sent,t=l(e.expires_in),a=e.access_token,p={accessToken:a,expires:t};case 6:case"end":return r.stop()}}))},v=function(e){localStorage.setItem("fromStop",JSON.stringify(e))},w=function(e){localStorage.setItem("destinationStop",JSON.stringify(e))},x=function(){return JSON.parse(localStorage.getItem("fromStop"))},T=function(){return JSON.parse(localStorage.getItem("destinationStop"))},S={name:"G\xf6teborg Nordstan",id:"9021014004945000"},g={name:"Partille Centrum",id:"9021014013215000"},k=function(e){var t=e.timeTable,a=t[0].time,r=t[0].rtTime;return n.a.createElement("div",{className:"TheTime"},n.a.createElement("div",{className:"TheTimeBlock"}),n.a.createElement("div",{className:"TheTimeBlock"},n.a.createElement("h1",{className:"nextBusTime"},a)),n.a.createElement("div",{className:"TheTimeBlock"},a!==r?n.a.createElement("h2",{className:"realTime"},"(",r,")"):""))},N=a(3),B=a(4),O=function(e){var t=e.timeTable;return n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement(N.a,{className:"busIcon",icon:B.a}),t[1].time),n.a.createElement("p",null,n.a.createElement(N.a,{className:"busIcon",icon:B.a}),t[2].time),n.a.createElement("p",null,n.a.createElement(N.a,{className:"busIcon",icon:B.a}),t[3].time))},D=function(e){var t=e.handleSwap,a=e.from,r=e.destination;return n.a.createElement("div",{className:"fromToWrapper"},n.a.createElement("div",{className:"fromTo"},n.a.createElement("h3",{className:"from",onClick:t},a.name)," ",n.a.createElement(N.a,{className:"exchangeArrows",onClick:t,icon:B.b}),n.a.createElement("h3",{className:"to"},r.name)))};var j=function(){var e=Object(r.useState)(),t=Object(u.a)(e,2),a=t[0],c=t[1],s=Object(r.useState)({isError:!1}),o=Object(u.a)(s,2),l=o[0],m=o[1],p=x(),f=Object(r.useState)(p||g),h=Object(u.a)(f,2),E=h[0],b=h[1],N=T(),B=Object(r.useState)(N||S),j=Object(u.a)(B,2),y=j[0],I=j[1],J=Object(r.useCallback)((function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(d(E.id));case 2:e=t.sent,W(e);case 4:case"end":return t.stop()}}))}),[E]);Object(r.useEffect)((function(){J()}),[J]);var W=function(e){if(e){if(e.DepartureBoard&&e.DepartureBoard.error)return void m({isError:!0,title:e.DepartureBoard.error,text:e.DepartureBoard.errorText});if(e.DepartureBoard.Departure)return c(e.DepartureBoard.Departure),void m({isError:!1})}m({isError:!0,title:"Oops!",text:"Something went wrong \ud83e\udd14"})};return n.a.createElement("div",{className:"App"},l.isError&&n.a.createElement(r.Fragment,null,n.a.createElement("h2",null,l.title),n.a.createElement("p",null,l.text)),a&&n.a.createElement(r.Fragment,null,n.a.createElement("div",{className:"TimeTable"},n.a.createElement(k,{timeTable:a}),n.a.createElement(O,{timeTable:a})),n.a.createElement(D,{handleSwap:function(){var e=E,t=y;b(t),I(e),v(t),w(e)},from:E,destination:y})),!l.isError&&!a&&n.a.createElement("p",null,"fetching data.."))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[10,1,2]]]);
//# sourceMappingURL=main.d968fc2c.chunk.js.map