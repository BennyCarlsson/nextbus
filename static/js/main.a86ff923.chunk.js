(this.webpackJsonpnextbus=this.webpackJsonpnextbus||[]).push([[0],{10:function(e,t,a){e.exports=a(23)},15:function(e,t,a){},17:function(e,t,a){},23:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),s=a.n(c),o=(a(15),a(2)),i=a.n(o),u=a(5),l=(a(17),{accessToken:"",expires:null}),m=function(){return JSON.parse(localStorage.getItem("fromStop"))},p=function(){return JSON.parse(localStorage.getItem("destinationStop"))},d=function(e,t){var a,n;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(h()){r.next=3;break}return r.next=3,i.a.awrap(b());case 3:return r.next=5,i.a.awrap(f(e,t));case 5:if(401!==(n=r.sent).status){r.next=12;break}return r.next=9,i.a.awrap(b());case 9:return r.next=11,i.a.awrap(f(e,t));case 11:n=r.sent;case 12:if(200!==n.status){r.next=17;break}return r.next=15,i.a.awrap(n.json());case 15:return a=r.sent,r.abrupt("return",a.DepartureBoard.Departure);case 17:return r.abrupt("return",a);case 18:case"end":return r.stop()}}))},f=function(e,t){var a,n,r,c,s;return i.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a=E(),n=a.date,r=a.time,c="https://api.vasttrafik.se/bin/rest.exe/v2/departureBoard?id=".concat(e,"&direction=").concat(t,"&date=").concat(n,"&time=").concat(r,"&format=json"),o.next=4,i.a.awrap(fetch(c,{method:"GET",headers:{Authorization:"Bearer ".concat(l.accessToken)}}));case 4:return s=o.sent,o.abrupt("return",s);case 6:case"end":return o.stop()}}))},h=function(){return!!l.accessToken&&!(l.expires&&l.expires<new Date)},b=function(){var e,t,a;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.awrap(w());case 2:e=n.sent,t=v(e.expires_in),a=e.access_token,l={accessToken:a,expires:t};case 6:case"end":return n.stop()}}))},v=function(e){var t=new Date;return t.setSeconds(t.getSeconds()+e),t},w=function(){var e,t;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.a.awrap(fetch("https://api.vasttrafik.se:443/token",{headers:{Authorization:"Basic ".concat("T0hDc2txdEp6cDhMYlVmRjhsaWVfeERHdDBBYTp6ME5wWWY3dlYxbUFhTEVFbkdyRFprTGEwODBh"),"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:"grant_type=client_credentials"}));case 2:return e=a.sent,a.next=5,i.a.awrap(e.json());case 5:return t=a.sent,a.abrupt("return",t);case 7:case"end":return a.stop()}}))},E=function(){var e=new Date;return{date:e.toISOString().substr(0,10),time:e.toTimeString().substr(0,5)}},x={name:"Partille Port",id:"9022014013213001"},T={name:"G\xf6teborg Nordstan",id:"9021014004945000"},S=function(e){var t=e.timeTable,a=t[0].time,n=t[0].rtTime;return r.a.createElement("div",{className:"TheTime"},r.a.createElement("div",{className:"TheTimeBlock"}),r.a.createElement("div",{className:"TheTimeBlock"},r.a.createElement("h1",{className:"nextBusTime"},a)),r.a.createElement("div",{className:"TheTimeBlock"},r.a.createElement("h2",{className:"realTime"},"(",n,")")))},k=a(3),N=a(4),g=function(e){var t=e.timeTable;return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(k.a,{className:"busIcon",icon:N.a}),t[1].time),r.a.createElement("p",null,r.a.createElement(k.a,{className:"busIcon",icon:N.a}),t[2].time),r.a.createElement("p",null,r.a.createElement(k.a,{className:"busIcon",icon:N.a}),t[3].time))},O=function(e){var t=e.handleSwap,a=e.from,n=e.destination;return r.a.createElement("div",{className:"fromToWrapper"},r.a.createElement("div",{className:"fromTo"},r.a.createElement("h3",{className:"from",onClick:t},a.name)," ",r.a.createElement(k.a,{className:"exchangeArrows",onClick:t,icon:N.b}),r.a.createElement("h3",{className:"to"},n.name)))};var y=function(){var e=Object(n.useState)(),t=Object(u.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(m()?m():x),o=Object(u.a)(s,2),l=o[0],f=o[1],h=Object(n.useState)(p()?p:T),b=Object(u.a)(h,2),v=b[0],w=b[1],E=Object(n.useCallback)((function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(d(l.id,v.id));case 2:e=t.sent,c(e);case 4:case"end":return t.stop()}}))}),[l,v]);return Object(n.useEffect)((function(){E()}),[E]),r.a.createElement(n.Fragment,null,a?r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"TimeTable"},r.a.createElement(S,{timeTable:a}),r.a.createElement(g,{timeTable:a})),r.a.createElement(O,{handleSwap:function(){var e=l,t=v;f(t),w(e),function(e){localStorage.setItem("fromStop",JSON.stringify(e))}(t),function(e){localStorage.setItem("destinationStop",JSON.stringify(e))}(e)},from:l,destination:v})):"")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[10,1,2]]]);
//# sourceMappingURL=main.a86ff923.chunk.js.map